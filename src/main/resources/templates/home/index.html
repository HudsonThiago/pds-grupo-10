<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Criação de Projeto</title>
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+Z58SLqOqk8WQu2Ew0MId5Ppzr+D5X"
            crossorigin="anonymous"
        />
        <script
            src="https://kit.fontawesome.com/7fd798150d.js"
            crossorigin="anonymous"
        ></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Roboto:ital,wght@0,100;0,300;0,500;0,700;1,900&display=swap"
            rel="stylesheet"
        />
        <link rel="stylesheet" th:href="@{/css/core.css}" />
        <link rel="stylesheet" th:href="@{/css/inputs.css}" />
        <link rel="stylesheet" th:href="@{/css/containers.css}" />
    </head>
    <body>
        <img
            class="homeLayer"
            th:src="@{/image/homeLayer.svg}"
            alt="homeLayer"
            draggable="false"
        />
        <div class="container homeContainer">
            <div class="leftColumn">
                <a class="backButton"></a>
                <h1 class="boldTitle">Login</h1>
                <form method="post">
                    <label class="inputContainer" for="email">
                        <h4 class="inputLabel">Email</h4>
                        <div class="inputBox">
                            <div class="inputIconBox">
                                <i class="fa-solid fa-envelope"></i>
                            </div>
                            <input
                                class="textField"
                                id="email"
                                name="email"
                                type="email"
                                required
                            />
                        </div>
                    </label>

                    <label class="inputContainer" for="senha">
                        <h4 class="inputLabel">Senha</h4>
                        <div class="inputBox">
                            <div class="inputIconBox">
                                <i class="fa-solid fa-lock"></i>
                            </div>
                            <input
                                class="textField"
                                id="senha"
                                name="senha"
                                type="password"
                                required
                            />
                        </div>
                        <div class="errorText">
                            <i class="fa-solid fa-circle-xmark"></i>
                            <p>Email ou senha incorreta, tente de novo</p>
                        </div>
                    </label>
                    <a class="registerButton" th:href="@{/cadastro}">
                        Não possui uma conta?
                        <span>cadastre-se</span>
                    </a>
                    <button class="button" type="submit">Entrar</button>
                </form>
            </div>
        </div>

    <script>
        document.querySelector('form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from submitting normally

            // Get the form values
            const email = document.getElementById('email').value;
            const senha = document.getElementById('senha').value;

            // Create the request body
            const requestBody = {
                email: email,
                senha: senha
            };

            // Send the POST request
            fetch('/usuarios/authenticate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            })
                .then(response => {
                    if (response.ok) {
                        window.location.href = '/explorar-projetos';
                    } else {
                        location.reload();
                    }
                })
                .catch(error => {
                    // Handle network error
                    console.error('Network error', error);
                });
        });
    </script>
    </body>
</html>
